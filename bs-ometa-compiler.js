// This file was generated using Gnometa
// https://github.com/djdeath/gnometa

let Locals=objectThatDelegatesTo(OMeta,{
"trans":function(){var $elf=this,$vars={},$r0=this._createStructure("trans");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);$vars.t=this._appendStructure($r2,this.anything());this._pred(($vars.t == "name"));$r2.value=($vars.n=this._appendStructure($r2,this.anything()));return $r2;}));$r1.value=[$vars.t,this._renameVariable($vars.n)];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);$vars.t=this._appendStructure($r2,this.anything());this._pred(($vars.t == "get"));$r2.value=($vars.n=this._appendStructure($r2,this.anything()));return $r2;}));$r1.value=[$vars.t,this._renameVariable($vars.n)];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);$vars.t=this._appendStructure($r2,this.anything());$r2.value=($vars.ts=this._appendStructure($r2,this._many(function(){var $r3=this._createStructure(null);$vars.e=this._appendStructure($r3,this._lookahead(function(){return this.anything();}));$r3.value=this._appendStructure($r3,this._or(function(){var $r4=this._createStructure(null);this._pred(((((typeof $vars.e) != "string") && ($vars.e["length"] != undefined)) && ($vars.e["length"] > (0))));$r4.value=this._appendStructure($r4,this._apply("trans"));return $r4;},function(){return this.anything();}));return $r3;})));return $r2;}));$r1.value=[$vars.t].concat($vars.ts);return $r1;}));return $r0;},
"rename":function(){var $elf=this,$vars={},$r0=this._createStructure("rename");this._appendStructure($r0,this._form(function(){var $r1=this._createStructure(null);$vars.allowed=this._appendStructure($r1,this.anything());(this["_allowed"]=$vars.allowed);$r1.value=($vars.result=this._appendStructure($r1,this._apply("trans")));return $r1;}));$r0.value=$vars.result;return $r0;}});(Locals["_renameVariable"]=(function (name){if(((name != "$elf") && this["_allowed"][name])){return ("$vars." + name);}else{undefined;}return name;}));let BSSemActionParser=objectThatDelegatesTo(BSJSParser,{
"curlySemAction":function(){var $elf=this,$vars={},$r0=this._createStructure("curlySemAction");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","{"));$vars.r=this._appendStructure($r1,this._apply("expr"));this._appendStructure($r1,this._apply("sc"));this._appendStructure($r1,this._applyWithArgs("token","}"));$r1.value=$vars.r;return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","{"));$vars.ss=this._appendStructure($r1,this._many(function(){var $r2=this._createStructure(null);$vars.s=this._appendStructure($r2,this._apply("srcElem"));this._appendStructure($r2,this._lookahead(function(){return this._apply("srcElem");}));$r2.value=$vars.s;return $r2;}));$vars.s=this._appendStructure($r1,this._or(function(){var $r2=this._createStructure(null);$vars.r=this._appendStructure($r2,this._apply("expr"));this._appendStructure($r2,this._apply("sc"));$r2.value=["return",$vars.r];return $r2;},function(){return this._apply("srcElem");}));$vars.ss.push($vars.s);this._appendStructure($r1,this._applyWithArgs("token","}"));$r1.value=["send","call",["func",[],["begin"].concat($vars.ss)],["this"]];return $r1;}));return $r0;},
"semAction":function(){var $elf=this,$vars={},$r0=this._createStructure("semAction");$r0.value=this._appendStructure($r0,this._or(function(){return this._apply("curlySemAction");},function(){var $r1=this._createStructure(null);$vars.r=this._appendStructure($r1,this._apply("primExpr"));this._appendStructure($r1,this._apply("spaces"));$r1.value=$vars.r;return $r1;}));return $r0;}});let BSOMetaParser=objectThatDelegatesTo(BaseStrParser,{
"enum":function(){var $elf=this,$vars={},$r0=this._createStructure("enum");$vars.r=this._appendStructure($r0,this.anything());$vars.d=this._appendStructure($r0,this.anything());$vars.v=this._appendStructure($r0,this._applyWithArgs("listOf",$vars.r,$vars.d));this._appendStructure($r0,this._or(function(){return this._applyWithArgs("token",",");},function(){return this._apply("empty");}));$r0.value=$vars.v;return $r0;},
"space":function(){var $elf=this,$vars={},$r0=this._createStructure("space");$r0.value=this._appendStructure($r0,this._or(function(){return BaseStrParser._superApplyWithArgs(this,'space');},function(){return this._applyWithArgs("fromTo","//","\n");},function(){return this._applyWithArgs("fromTo","/*","*/");}));return $r0;},
"nameFirst":function(){var $elf=this,$vars={},$r0=this._createStructure("nameFirst");$r0.value=this._appendStructure($r0,this._or(function(){return (function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case "_":$r2.value="_";break;case "$":$r2.value="$";break;default: throw fail}return $r2;}).call(this);},function(){return this._apply("letter");}));return $r0;},
"nameRest":function(){var $elf=this,$vars={},$r0=this._createStructure("nameRest");$r0.value=this._appendStructure($r0,this._or(function(){return this._apply("nameFirst");},function(){return this._apply("digit");}));return $r0;},
"tsName":function(){var $elf=this,$vars={},$r0=this._createStructure("tsName");$r0.value=this._appendStructure($r0,this._consumedBy(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("nameFirst"));$r1.value=this._appendStructure($r1,this._many(function(){return this._apply("nameRest");}));return $r1;}));return $r0;},
"name":function(){var $elf=this,$vars={},$r0=this._createStructure("name");this._appendStructure($r0,this._apply("spaces"));$r0.value=this._appendStructure($r0,this._apply("tsName"));return $r0;},
"hexDigit":function(){var $elf=this,$vars={},$r0=this._createStructure("hexDigit");$vars.x=this._appendStructure($r0,this._apply("char"));$vars.v=this["hexDigits"].indexOf($vars.x.toLowerCase());this._pred(($vars.v >= (0)));$r0.value=$vars.v;return $r0;},
"eChar":function(){var $elf=this,$vars={},$r0=this._createStructure("eChar");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.s=this._appendStructure($r1,this._consumedBy(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this.exactly("\\"));$r2.value=this._appendStructure($r2,this._or(function(){return (function(){var $r4=this._createStructure(null);switch(this._appendStructure($r4,this._apply('anything'))){case "u":this._appendStructure($r4,this._apply("hexDigit"));this._appendStructure($r4,this._apply("hexDigit"));this._appendStructure($r4,this._apply("hexDigit"));$r4.value=this._appendStructure($r4,this._apply("hexDigit"));break;case "x":this._appendStructure($r4,this._apply("hexDigit"));$r4.value=this._appendStructure($r4,this._apply("hexDigit"));break;default: throw fail}return $r4;}).call(this);},function(){return this._apply("char");}));return $r2;}));$r1.value=unescape($vars.s);return $r1;},function(){return this._apply("char");}));return $r0;},
"tsString":function(){var $elf=this,$vars={},$r0=this._createStructure("tsString");this._appendStructure($r0,this.exactly("\'"));$vars.xs=this._appendStructure($r0,this._many(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._not(function(){return this.exactly("\'");}));$r1.value=this._appendStructure($r1,this._apply("eChar"));return $r1;}));this._appendStructure($r0,this.exactly("\'"));$r0.value=$vars.xs.join("");return $r0;},
"characters":function(){var $elf=this,$vars={},$r0=this._createStructure("characters");this._appendStructure($r0,this.exactly("`"));this._appendStructure($r0,this.exactly("`"));$vars.xs=this._appendStructure($r0,this._many(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._not(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this.exactly("\'"));$r2.value=this._appendStructure($r2,this.exactly("\'"));return $r2;}));$r1.value=this._appendStructure($r1,this._apply("eChar"));return $r1;}));this._appendStructure($r0,this.exactly("\'"));this._appendStructure($r0,this.exactly("\'"));$r0.value=["App","seq",$vars.xs.join("").toProgramString()];return $r0;},
"sCharacters":function(){var $elf=this,$vars={},$r0=this._createStructure("sCharacters");this._appendStructure($r0,this.exactly("\""));$vars.xs=this._appendStructure($r0,this._many(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._not(function(){return this.exactly("\"");}));$r1.value=this._appendStructure($r1,this._apply("eChar"));return $r1;}));this._appendStructure($r0,this.exactly("\""));$r0.value=["App","token",$vars.xs.join("").toProgramString()];return $r0;},
"string":function(){var $elf=this,$vars={},$r0=this._createStructure("string");$vars.xs=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,(function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case "#":$r2.value="#";break;case "`":$r2.value="`";break;default: throw fail}return $r2;}).call(this));$r1.value=this._appendStructure($r1,this._apply("tsName"));return $r1;},function(){return this._apply("tsString");}));$r0.value=["App","exactly",$vars.xs.toProgramString()];return $r0;},
"number":function(){var $elf=this,$vars={},$r0=this._createStructure("number");$vars.n=this._appendStructure($r0,this._consumedBy(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._opt(function(){return this.exactly("-");}));$r1.value=this._appendStructure($r1,this._many1(function(){return this._apply("digit");}));return $r1;}));$r0.value=["App","exactly",$vars.n];return $r0;},
"keyword":function(){var $elf=this,$vars={},$r0=this._createStructure("keyword");$vars.xs=this._appendStructure($r0,this.anything());this._appendStructure($r0,this._applyWithArgs("token",$vars.xs));this._appendStructure($r0,this._not(function(){return this._apply("letterOrDigit");}));$r0.value=$vars.xs;return $r0;},
"args":function(){var $elf=this,$vars={},$r0=this._createStructure("args");$r0.value=this._appendStructure($r0,this._or(function(){return (function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case "(":$vars.xs=this._appendStructure($r2,this._applyWithArgs("listOf","hostExpr",","));this._appendStructure($r2,this._applyWithArgs("token",")"));$r2.value=$vars.xs;break;default: throw fail}return $r2;}).call(this);},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("empty"));$r1.value=[];return $r1;}));return $r0;},
"application":function(){var $elf=this,$vars={},$r0=this._createStructure("application");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","^"));$vars.rule=this._appendStructure($r1,this._apply("name"));$vars.as=this._appendStructure($r1,this._apply("args"));$r1.value=["App","super",(("\'" + $vars.rule) + "\'")].concat($vars.as);return $r1;},function(){var $r1=this._createStructure(null);$vars.grm=this._appendStructure($r1,this._apply("name"));this._appendStructure($r1,this._applyWithArgs("token","."));$vars.rule=this._appendStructure($r1,this._apply("name"));$vars.as=this._appendStructure($r1,this._apply("args"));$r1.value=["App","foreign",$vars.grm,(("\'" + $vars.rule) + "\'")].concat($vars.as);return $r1;},function(){var $r1=this._createStructure(null);$vars.rule=this._appendStructure($r1,this._apply("name"));$vars.as=this._appendStructure($r1,this._apply("args"));$r1.value=["App",$vars.rule].concat($vars.as);return $r1;}));return $r0;},
"localsVars":function(){var $elf=this,$vars={},$r0=this._createStructure("localsVars");$vars.s=this._appendStructure($r0,this.anything());$r0.value=this._appendStructure($r0,this._applyWithArgs("foreign",Locals,'rename',[this["locals"],$vars.s]));return $r0;},
"hostExpr":function(){var $elf=this,$vars={},$r0=this._createStructure("hostExpr");$vars.r=this._appendStructure($r0,this._applyWithArgs("foreign",BSSemActionParser,'expr'));$vars.rr=this._appendStructure($r0,this._applyWithArgs("localsVars",$vars.r));$r0.value=this._appendStructure($r0,this._applyWithArgs("foreign",BSJSTranslator,'trans',$vars.rr));return $r0;},
"curlyHostExpr":function(){var $elf=this,$vars={},$r0=this._createStructure("curlyHostExpr");$vars.r=this._appendStructure($r0,this._applyWithArgs("foreign",BSSemActionParser,'curlySemAction'));$vars.rr=this._appendStructure($r0,this._applyWithArgs("localsVars",$vars.r));$r0.value=this._appendStructure($r0,this._applyWithArgs("foreign",BSJSTranslator,'trans',$vars.rr));return $r0;},
"primHostExpr":function(){var $elf=this,$vars={},$r0=this._createStructure("primHostExpr");$vars.r=this._appendStructure($r0,this._applyWithArgs("foreign",BSSemActionParser,'semAction'));$vars.rr=this._appendStructure($r0,this._applyWithArgs("localsVars",$vars.r));$r0.value=this._appendStructure($r0,this._applyWithArgs("foreign",BSJSTranslator,'trans',$vars.rr));return $r0;},
"atomicHostExpr":function(){var $elf=this,$vars={},$r0=this._createStructure("atomicHostExpr");$r0.value=this._appendStructure($r0,this._or(function(){return this._apply("curlyHostExpr");},function(){return this._apply("primHostExpr");}));return $r0;},
"semAction":function(){var $elf=this,$vars={},$r0=this._createStructure("semAction");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this._apply("curlyHostExpr"));$r1.value=["Act",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","!"));$vars.x=this._appendStructure($r1,this._apply("atomicHostExpr"));$r1.value=["Act",$vars.x];return $r1;}));return $r0;},
"arrSemAction":function(){var $elf=this,$vars={},$r0=this._createStructure("arrSemAction");this._appendStructure($r0,this._applyWithArgs("token","->"));$vars.x=this._appendStructure($r0,this._apply("atomicHostExpr"));$r0.value=["Act",$vars.x];return $r0;},
"semPred":function(){var $elf=this,$vars={},$r0=this._createStructure("semPred");this._appendStructure($r0,this._applyWithArgs("token","?"));$vars.x=this._appendStructure($r0,this._apply("atomicHostExpr"));$r0.value=["Pred",$vars.x];return $r0;},
"expr":function(){var $elf=this,$vars={},$r0=this._createStructure("expr");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this._applyWithArgs("expr5",true));$vars.xs=this._appendStructure($r1,this._many1(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this._applyWithArgs("token","|"));$r2.value=this._appendStructure($r2,this._applyWithArgs("expr5",true));return $r2;}));$r1.value=["Or",$vars.x].concat($vars.xs);return $r1;},function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this._applyWithArgs("expr5",true));$vars.xs=this._appendStructure($r1,this._many1(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this._applyWithArgs("token","||"));$r2.value=this._appendStructure($r2,this._applyWithArgs("expr5",true));return $r2;}));$r1.value=["XOr",$vars.x].concat($vars.xs);return $r1;},function(){return this._applyWithArgs("expr5",false);}));return $r0;},
"expr5":function(){var $elf=this,$vars={},$r0=this._createStructure("expr5");$vars.ne=this._appendStructure($r0,this.anything());$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this._apply("interleavePart"));$vars.xs=this._appendStructure($r1,this._many1(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this._applyWithArgs("token","&&"));$r2.value=this._appendStructure($r2,this._apply("interleavePart"));return $r2;}));$r1.value=["Interleave",$vars.x].concat($vars.xs);return $r1;},function(){return this._applyWithArgs("expr4",$vars.ne);}));return $r0;},
"interleavePart":function(){var $elf=this,$vars={},$r0=this._createStructure("interleavePart");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","("));$vars.part=this._appendStructure($r1,this._applyWithArgs("expr4",true));this._appendStructure($r1,this._applyWithArgs("token",")"));$r1.value=["1",$vars.part];return $r1;},function(){var $r1=this._createStructure(null);$vars.part=this._appendStructure($r1,this._applyWithArgs("expr4",true));$r1.value=this._appendStructure($r1,this._applyWithArgs("modedIPart",$vars.part));return $r1;}));return $r0;},
"modedIPart":function(){var $elf=this,$vars={},$r0=this._createStructure("modedIPart");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this.exactly("And"));$r2.value=this._appendStructure($r2,this._form(function(){var $r3=this._createStructure(null);this._appendStructure($r3,this.exactly("Many"));$r3.value=($vars.part=this._appendStructure($r3,this.anything()));return $r3;}));return $r2;}));$r1.value=["*",$vars.part];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this.exactly("And"));$r2.value=this._appendStructure($r2,this._form(function(){var $r3=this._createStructure(null);this._appendStructure($r3,this.exactly("Many1"));$r3.value=($vars.part=this._appendStructure($r3,this.anything()));return $r3;}));return $r2;}));$r1.value=["+",$vars.part];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);this._appendStructure($r2,this.exactly("And"));$r2.value=this._appendStructure($r2,this._form(function(){var $r3=this._createStructure(null);this._appendStructure($r3,this.exactly("Opt"));$r3.value=($vars.part=this._appendStructure($r3,this.anything()));return $r3;}));return $r2;}));$r1.value=["?",$vars.part];return $r1;},function(){var $r1=this._createStructure(null);$vars.part=this._appendStructure($r1,this.anything());$r1.value=["1",$vars.part];return $r1;}));return $r0;},
"expr4":function(){var $elf=this,$vars={},$r0=this._createStructure("expr4");$vars.ne=this._appendStructure($r0,this.anything());$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.xs=this._appendStructure($r1,this._many(function(){return this._apply("expr3");}));$vars.act=this._appendStructure($r1,this._apply("arrSemAction"));$r1.value=["And"].concat($vars.xs).concat([$vars.act]);return $r1;},function(){var $r1=this._createStructure(null);this._pred($vars.ne);$vars.xs=this._appendStructure($r1,this._many1(function(){return this._apply("expr3");}));$r1.value=["And"].concat($vars.xs);return $r1;},function(){var $r1=this._createStructure(null);this._pred(($vars.ne == false));$vars.xs=this._appendStructure($r1,this._many(function(){return this._apply("expr3");}));$r1.value=["And"].concat($vars.xs);return $r1;}));return $r0;},
"optIter":function(){var $elf=this,$vars={},$r0=this._createStructure("optIter");$vars.x=this._appendStructure($r0,this.anything());$r0.value=this._appendStructure($r0,this._or(function(){return (function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case "*":$r2.value=["Many",$vars.x];break;case "+":$r2.value=["Many1",$vars.x];break;case "?":$r2.value=["Opt",$vars.x];break;default: throw fail}return $r2;}).call(this);},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("empty"));$r1.value=$vars.x;return $r1;}));return $r0;},
"optBind":function(){var $elf=this,$vars={},$r0=this._createStructure("optBind");$vars.x=this._appendStructure($r0,this.anything());$r0.value=this._appendStructure($r0,this._or(function(){return (function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case ":":$vars.n=this._appendStructure($r2,this._apply("name"));$r2.value=(function (){(this["locals"][$vars.n]=true);return ["Set",$vars.n,$vars.x];}).call(this);break;default: throw fail}return $r2;}).call(this);},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("empty"));$r1.value=$vars.x;return $r1;}));return $r0;},
"expr3":function(){var $elf=this,$vars={},$r0=this._createStructure("expr3");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token",":"));$vars.n=this._appendStructure($r1,this._apply("name"));$r1.value=(function (){(this["locals"][$vars.n]=true);return ["Set",$vars.n,["App","anything"]];}).call(this);return $r1;},function(){var $r1=this._createStructure(null);$vars.e=this._appendStructure($r1,this._or(function(){var $r2=this._createStructure(null);$vars.x=this._appendStructure($r2,this._apply("expr2"));$r2.value=this._appendStructure($r2,this._applyWithArgs("optIter",$vars.x));return $r2;},function(){return this._apply("semAction");}));$r1.value=this._appendStructure($r1,this._applyWithArgs("optBind",$vars.e));return $r1;},function(){return this._apply("semPred");}));return $r0;},
"expr2":function(){var $elf=this,$vars={},$r0=this._createStructure("expr2");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","~"));$vars.x=this._appendStructure($r1,this._apply("expr2"));$r1.value=["Not",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","&"));$vars.x=this._appendStructure($r1,this._apply("expr1"));$r1.value=["Lookahead",$vars.x];return $r1;},function(){return this._apply("expr1");}));return $r0;},
"expr1":function(){var $elf=this,$vars={},$r0=this._createStructure("expr1");$r0.value=this._appendStructure($r0,this._or(function(){return this._apply("application");},function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this._or(function(){return this._applyWithArgs("keyword","undefined");},function(){return this._applyWithArgs("keyword","nil");},function(){return this._applyWithArgs("keyword","true");},function(){return this._applyWithArgs("keyword","false");}));$r1.value=["App","exactly",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("spaces"));$r1.value=this._appendStructure($r1,this._or(function(){return this._apply("characters");},function(){return this._apply("sCharacters");},function(){return this._apply("string");},function(){return this._apply("number");}));return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","["));$vars.x=this._appendStructure($r1,this._apply("expr"));this._appendStructure($r1,this._applyWithArgs("token","]"));$r1.value=["Form",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","<"));$vars.x=this._appendStructure($r1,this._apply("expr"));this._appendStructure($r1,this._applyWithArgs("token",">"));$r1.value=["ConsBy",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","@<"));$vars.x=this._appendStructure($r1,this._apply("expr"));this._appendStructure($r1,this._applyWithArgs("token",">"));$r1.value=["IdxConsBy",$vars.x];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","("));$vars.x=this._appendStructure($r1,this._apply("expr"));this._appendStructure($r1,this._applyWithArgs("token",")"));$r1.value=$vars.x;return $r1;}));return $r0;},
"ruleName":function(){var $elf=this,$vars={},$r0=this._createStructure("ruleName");$r0.value=this._appendStructure($r0,this._or(function(){return this._apply("name");},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("spaces"));$r1.value=this._appendStructure($r1,this._apply("tsString"));return $r1;}));return $r0;},
"rule":function(){var $elf=this,$vars={},$r0=this._createStructure("rule");this._appendStructure($r0,this._lookahead(function(){var $r1=this._createStructure(null);$r1.value=($vars.n=this._appendStructure($r1,this._apply("ruleName")));return $r1;}));(this["locals"]=({}));$vars.x=this._appendStructure($r0,this._applyWithArgs("rulePart",$vars.n));$vars.xs=this._appendStructure($r0,this._many(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token",","));$r1.value=this._appendStructure($r1,this._applyWithArgs("rulePart",$vars.n));return $r1;}));$r0.value=["Rule",$vars.n,["Or",$vars.x].concat($vars.xs)];return $r0;},
"rulePart":function(){var $elf=this,$vars={},$r0=this._createStructure("rulePart");$vars.rn=this._appendStructure($r0,this.anything());$vars.n=this._appendStructure($r0,this._apply("ruleName"));this._pred(($vars.n == $vars.rn));$vars.b1=this._appendStructure($r0,this._applyWithArgs("expr4",false));$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","="));$vars.b2=this._appendStructure($r1,this._apply("expr"));$r1.value=["And",$vars.b1,$vars.b2];return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("empty"));$r1.value=$vars.b1;return $r1;}));return $r0;},
"grammar":function(){var $elf=this,$vars={},$r0=this._createStructure("grammar");this._appendStructure($r0,this._applyWithArgs("keyword","ometa"));$vars.sn=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._applyWithArgs("token","("));$vars.sni=this._appendStructure($r1,this._apply("name"));this._appendStructure($r1,this._applyWithArgs("token",")"));$r1.value=$vars.sni;return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._apply("empty"));$r1.value="OMeta";return $r1;}));this._appendStructure($r0,this._applyWithArgs("token","{"));$vars.rs=this._appendStructure($r0,this._applyWithArgs("enum","rule",","));this._appendStructure($r0,this._applyWithArgs("token","}"));$r0.value=this._appendStructure($r0,this._applyWithArgs("foreign",BSOMetaOptimizer,'optimizeGrammar',["Grammar",$vars.sn].concat($vars.rs)));return $r0;}});(BSOMetaParser["hexDigits"]="0123456789abcdef");let BSOMetaTranslator=objectThatDelegatesTo(OMeta,{
"App":function(){var $elf=this,$vars={},$r0=this._createStructure("App");$r0.value=this._appendStructure($r0,this._or(function(){return (function(){var $r2=this._createStructure(null);switch(this._appendStructure($r2,this._apply('anything'))){case "super":$vars.args=this._appendStructure($r2,this._many1(function(){return this.anything();}));$r2.value=[this["sName"],"._superApplyWithArgs(this,",$vars.args.join(","),")"].join("");break;default: throw fail}return $r2;}).call(this);},function(){var $r1=this._createStructure(null);$vars.rule=this._appendStructure($r1,this.anything());$vars.args=this._appendStructure($r1,this._many(function(){return this.anything();}));$r1.value=this._appendStructure($r1,this._or(function(){var $r2=this._createStructure(null);this._pred(this._optimizedCall($vars.rule,$vars.args));$r2.value=["this.",this["_callables"][$vars.rule]["name"],"(",$vars.args.join(","),")"].join("");return $r2;},function(){var $r2=this._createStructure(null);this._pred(($vars.args["length"] < (1)));$r2.value=["this._apply(\"",$vars.rule,"\")"].join("");return $r2;},function(){var $r2=this._createStructure(null);$r2.value=["this._applyWithArgs(\"",$vars.rule,"\",",$vars.args.join(","),")"].join("");return $r2;}));return $r1;}));return $r0;},
"Act":function(){var $elf=this,$vars={},$r0=this._createStructure("Act");$vars.expr=this._appendStructure($r0,this.anything());$r0.value=$vars.expr;return $r0;},
"Pred":function(){var $elf=this,$vars={},$r0=this._createStructure("Pred");$vars.expr=this._appendStructure($r0,this.anything());$r0.value=["this._pred(",$vars.expr,")"].join("");return $r0;},
"Or":function(){var $elf=this,$vars={},$r0=this._createStructure("Or");$vars.xs=this._appendStructure($r0,this._many(function(){return this._apply("transFn");}));$r0.value=["this._or(",$vars.xs.join(","),")"].join("");return $r0;},
"XOr":function(){var $elf=this,$vars={},$r0=this._createStructure("XOr");$vars.xs=this._appendStructure($r0,this._many(function(){return this._apply("transFn");}));$vars.xs.unshift(this["rName"].toProgramString());$r0.value=["this._xor(",$vars.xs.join(","),")"].join("");return $r0;},
"And":function(){var $elf=this,$vars={},$r0=this._createStructure("And");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);$vars.xs=this._appendStructure($r1,this._many1(function(){return this._apply("transFn");}));$r1.value=$vars.xs.join(";");return $r1;},function(){var $r1=this._createStructure(null);$r1.value="undefined";return $r1;}));return $r0;},
"Opt":function(){var $elf=this,$vars={},$r0=this._createStructure("Opt");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._opt(",$vars.x,")"].join("");return $r0;},
"Many":function(){var $elf=this,$vars={},$r0=this._createStructure("Many");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._many(",$vars.x,")"].join("");return $r0;},
"Many1":function(){var $elf=this,$vars={},$r0=this._createStructure("Many1");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._many1(",$vars.x,")"].join("");return $r0;},
"Set":function(){var $elf=this,$vars={},$r0=this._createStructure("Set");$vars.n=this._appendStructure($r0,this.anything());$vars.v=this._appendStructure($r0,this._apply("trans"));$r0.value=["$vars.",$vars.n,"=",$vars.v].join("");return $r0;},
"Not":function(){var $elf=this,$vars={},$r0=this._createStructure("Not");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._not(",$vars.x,")"].join("");return $r0;},
"Lookahead":function(){var $elf=this,$vars={},$r0=this._createStructure("Lookahead");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._lookahead(",$vars.x,")"].join("");return $r0;},
"Form":function(){var $elf=this,$vars={},$r0=this._createStructure("Form");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._form(",$vars.x,")"].join("");return $r0;},
"ConsBy":function(){var $elf=this,$vars={},$r0=this._createStructure("ConsBy");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._consumedBy(",$vars.x,")"].join("");return $r0;},
"IdxConsBy":function(){var $elf=this,$vars={},$r0=this._createStructure("IdxConsBy");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._idxConsumedBy(",$vars.x,")"].join("");return $r0;},
"JumpTable":function(){var $elf=this,$vars={},$r0=this._createStructure("JumpTable");this["_storeVar"]++;$vars.cases=this._appendStructure($r0,this._many(function(){return this._apply("jtCase");}));this["_storeVar"]--;$r0.value=this.jumpTableCode($vars.cases);return $r0;},
"Interleave":function(){var $elf=this,$vars={},$r0=this._createStructure("Interleave");$vars.xs=this._appendStructure($r0,this._many(function(){return this._apply("intPart");}));$r0.value=["this._interleave(",$vars.xs.join(","),")"].join("");return $r0;},
"Function":function(){var $elf=this,$vars={},$r0=this._createStructure("Function");this["_storeVar"]++;$vars.x=this._appendStructure($r0,this._apply("transFn"));this["_storeVar"]--;$r0.value=["function(){",$vars.x,";}"].join("");return $r0;},
"FunctionStructure":function(){var $elf=this,$vars={},$r0=this._createStructure("FunctionStructure");this["_storeVar"]++;$vars.xs=this._appendStructure($r0,this._many1(function(){return this._apply("transFn");}));this["_storeVar"]--;$r0.value=["function(){var $r",(this["_storeVar"] + (1)),"=this._createStructure(null);",$vars.xs.join(";"),";return $r",(this["_storeVar"] + (1)),";}"].join("");return $r0;},
"ReturnStructure":function(){var $elf=this,$vars={},$r0=this._createStructure("ReturnStructure");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["$r",this["_storeVar"],".value=",$vars.x].join("");return $r0;},
"Return":function(){var $elf=this,$vars={},$r0=this._createStructure("Return");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["return ",$vars.x].join("");return $r0;},
"Parenthesis":function(){var $elf=this,$vars={},$r0=this._createStructure("Parenthesis");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["(",$vars.x,")"].join("");return $r0;},
"Store":function(){var $elf=this,$vars={},$r0=this._createStructure("Store");$vars.x=this._appendStructure($r0,this._apply("transFn"));$r0.value=["this._appendStructure($r",this["_storeVar"],",",$vars.x,")"].join("");return $r0;},
"Rule":function(){var $elf=this,$vars={},$r0=this._createStructure("Rule");$vars.name=this._appendStructure($r0,this.anything());(function (){(this["rName"]=$vars.name);return (this["_storeVar"]=(0));}).call(this);$vars.body=this._appendStructure($r0,this._apply("trans"));$r0.value=["\n\"",$vars.name,"\":function(){var $elf=this,","$vars={},","$r0=this._createStructure(\"",$vars.name,"\");",$vars.body,";return $r0;}"].join("");return $r0;},
"Grammar":function(){var $elf=this,$vars={},$r0=this._createStructure("Grammar");$vars.sName=this._appendStructure($r0,this.anything());(this["sName"]=$vars.sName);$vars.rules=this._appendStructure($r0,this._many(function(){return this._apply("trans");}));$r0.value=["objectThatDelegatesTo(",$vars.sName,",{",$vars.rules.join(","),"})"].join("");return $r0;},
"intPart":function(){var $elf=this,$vars={},$r0=this._createStructure("intPart");this._appendStructure($r0,this._form(function(){var $r1=this._createStructure(null);$vars.mode=this._appendStructure($r1,this.anything());$r1.value=($vars.part=this._appendStructure($r1,this._apply("transFn")));return $r1;}));$r0.value=(($vars.mode.toProgramString() + ",") + $vars.part);return $r0;},
"jtCase":function(){var $elf=this,$vars={},$r0=this._createStructure("jtCase");this._appendStructure($r0,this._form(function(){var $r1=this._createStructure(null);$vars.x=this._appendStructure($r1,this.anything());$r1.value=($vars.e=this._appendStructure($r1,this._apply("trans")));return $r1;}));$r0.value=[$vars.x.toProgramString(),$vars.e];return $r0;},
"locals":function(){var $elf=this,$vars={},$r0=this._createStructure("locals");$r0.value=this._appendStructure($r0,this._or(function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);$r2.value=($vars.vs=this._appendStructure($r2,this._many1(function(){return this._apply("string");})));return $r2;}));$r1.value=["var ",$vars.vs.join(","),";"].join("");return $r1;},function(){var $r1=this._createStructure(null);this._appendStructure($r1,this._form(function(){var $r2=this._createStructure(null);$r2.value=undefined;return $r2;}));$r1.value="";return $r1;}));return $r0;},
"trans":function(){var $elf=this,$vars={},$r0=this._createStructure("trans");this._appendStructure($r0,this._form(function(){var $r1=this._createStructure(null);$vars.t=this._appendStructure($r1,this.anything());$r1.value=($vars.ans=this._appendStructure($r1,this._apply($vars.t)));return $r1;}));$r0.value=$vars.ans;return $r0;},
"transFn":function(){var $elf=this,$vars={},$r0=this._createStructure("transFn");$vars.x=this._appendStructure($r0,this._apply("trans"));$r0.value=$vars.x;return $r0;}});(BSOMetaTranslator["_callables"]=({"anything": ({"name": "anything","nbArgs": (0)}),"apply": ({"name": "_apply","nbArgs": (1)}),"end": ({"name": "end","nbArgs": (0)}),"exactly": ({"name": "exactly","nbArgs": (1)}),"seq": ({"name": "seq","nbArgs": (1)})}));(BSOMetaTranslator["_optimizedCall"]=(function (rule,args){let c=this["_callables"][rule];return (c && (c["nbArgs"] == args["length"]));}));(BSOMetaTranslator["jumpTableCode"]=(function (cases){var buf=new StringBuffer();buf.nextPutAll((("(function(){var $r" + (this["_storeVar"] + (1))) + "=this._createStructure(null);"));buf.nextPutAll((("switch(this._appendStructure($r" + (this["_storeVar"] + (1))) + ",this._apply(\'anything\'))){"));for(var i=(0);(i < cases["length"]);(i+=(1))){buf.nextPutAll((((("case " + cases[i][(0)]) + ":") + cases[i][(1)]) + ";break;"));}buf.nextPutAll((("default: throw fail}return $r" + (this["_storeVar"] + (1))) + ";}).call(this)"));return buf.contents();}))
